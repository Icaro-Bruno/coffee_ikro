<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>PÃ¡gina Do Produto</title>
    <link rel="stylesheet" th:href="@{/pagprod.css}">
    <link href="https://fonts.googleapis.com/css2?family=Merienda:wght@300..900&display=swap" rel="stylesheet">
</head>
<body>

<header class="cabecalho">
    <button id="menu-toggle">â˜°</button>

    <div id="carrinho">
        ðŸ›’ <span id="carrinho-count">0</span>
    </div>
</header>

<nav id="menu" class="hidden">
    <div class="menu-content">
        <ul>
            <li><a href="#">Pedir Via Whatsapp</a></li>
            <li><a href="#">PromoÃ§Ãµes</a></li>
        </ul>
    </div>
</nav>

<section class="produto-container">
    <h1 th:text="${pagProduto.nome}" class="produto-nome">Nome do Produto</h1>

    <img th:src="${pagProduto.imgUrl}" alt="Imagem do Produto" class="produto-img">

    <span id="preco-unitario" th:data-preco="${pagProduto.preco}" style="display:none;"></span>
</section>

<main class="produto-descricao">
    <h2>DescriÃ§Ã£o</h2>
    <p th:text="${pagProduto.descricao}">Descricao</p>
</main>

<footer class="produto-footer-fixo">
    <div class="controle-quantidade">
        <button id="menos">-</button>
        <input type="text" id="quantidade" value="1" readonly>
        <button id="mais">+</button>
    </div>

    <button id="botao-adicionar" class="botao-adicionar">
        R$ 0,00 | ADICIONAR
    </button>
</footer>

<script>
    const menosBtn = document.getElementById('menos');
    const maisBtn = document.getElementById('mais');
    const quantidadeInput = document.getElementById('quantidade');
    const precoUnitarioSpan = document.getElementById('preco-unitario');
    const botaoAdicionar = document.getElementById('botao-adicionar');

    function atualizarPrecoTotal() {
        const precoUnitario = parseFloat(precoUnitarioSpan.dataset.preco || 0);
        const quantidade = parseInt(quantidadeInput.value);
        const total = (precoUnitario * quantidade).toFixed(2).replace('.', ',');
        botaoAdicionar.innerText = `R$ ${total} | ADICIONAR`;
    }

    menosBtn.onclick = () => {
        let valor = parseInt(quantidadeInput.value);
        if (valor > 1) {
            quantidadeInput.value = valor - 1;
            atualizarPrecoTotal();
        }
    };

    maisBtn.onclick = () => {
        let valor = parseInt(quantidadeInput.value);
        quantidadeInput.value = valor + 1;
        atualizarPrecoTotal();
    };

    // Inicializa com preÃ§o certo
    window.onload = atualizarPrecoTotal;
</script>

<!--MENU-->
<script>
    const toggle = document.getElementById('menu-toggle');
    const menu = document.getElementById('menu');

    toggle.addEventListener('click', (event) => {
        event.stopPropagation();
        menu.classList.toggle('show');
    });

    document.addEventListener('click', (event) => {
        if (!menu.contains(event.target) && !toggle.contains(event.target)) {
            menu.classList.remove('show');
        }
    });
</script>


<!--CARRINHO-->
<script>
    let count = 0;
    const carrinhoCount = document.getElementById('carrinho-count');

    // Como os botÃµes "Adicionar" sÃ£o criados dinamicamente, espere o DOM carregar
    document.addEventListener('DOMContentLoaded', () => {
        const botoesAdicionar = document.querySelectorAll('.botao');

        botoesAdicionar.forEach(botao => {
            botao.addEventListener('click', () => {
                count++;
                carrinhoCount.textContent = count;
            });
        });
    });
</script>
</body>
</html>
